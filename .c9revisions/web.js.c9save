{"ts":1355178130259,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"var express = require('express');\nvar mongoose = require('mongoose');\nvar db = mongoose.createConnection('mongodb://localhost/mos');\nvar app = express.createServer();\n\ndb.on('error', console.error.bind(console, 'connection error:'));\ndb.once('open', function() {\n\tconsole.log(\"mongodb is on\");\n});\n\nvar OrderSchema = new mongoose.Schema({\n    time: Number,\n\ttype: String,\n\tdata: {\n\t\tcustomerID : Number,\n\t\tmerchantID : Number,\n\t\tprice : Number,\n\t\tdetails : \n\t\t\t[{item : String, num : Number}]\n\t}\n});\n\nvar Order = db.model('Order', OrderSchema);\n\napp.get('/', function(request, response) {\n  response.send('main page');\n});\napp.get('/list', function(req, res) {\n\treturn Order.find(function(err, orders){\n\t\tif(!err){\n\t\t\treturn res.send(orders);\n\t\t}\n\t\telse{\n\t\t\treturn console.log(err);\n\t\t}\n\t});\n});\n\nvar testJson = {\n\t\"service\":\"yesgoody-mos\", \n\t\"version\":\"alpha\",\n\t\"utc\":Date.now()};\n\t\napp.post('/api', function(req, res){\n\treq.on(\"data\", function(d){\n\t\t//console.log(d.toString());\n\t\ttestJson.params = req.params;\n\t\ttestJson.headers = req.headers;\n\t\ttestJson.query = req.query;\n\t\ttestJson.path = req.path;\n\t\ttestJson.data = JSON.parse(d);\n\t\tres.json(testJson);\n\t\tvar order = new Order(JSON.parse(d));\n\t\torder.save(function (err) {\n\t\t  if (!err) {\n\t\t\t  console.log(\"created!\");\n\t\t  }\n\t\t  else{\n\t\t  \tconsole.log(\"saving error\");\n\t\t  }\n\t\t});\n\t});\n});\n\nvar port = process.env.PORT || 5000;\napp.listen(port, function() {\n  console.log(\"Listening on \" + port);\n});\n"]],"start1":0,"start2":0,"length1":0,"length2":1458}]],"length":1458}
{"contributors":[],"silentsave":false,"ts":1355178207794,"patch":[[{"diffs":[[0,"b://"],[-1,"localhost/mos"],[1,"<dbuser>:<dbpassword>@ds045137.mongolab.com:45137/heroku_app9889853"],[0,"');\n"]],"start1":112,"start2":112,"length1":21,"length2":75}]],"length":1512,"saved":false}
{"ts":1355178225946,"patch":[[{"diffs":[[0,"b://"],[-1,"<dbuser>"],[1,"heroku_app9889853"],[0,":<db"]],"start1":112,"start2":112,"length1":16,"length2":25}]],"length":1521,"saved":false}
{"ts":1355178341535,"patch":[[{"diffs":[[0,"853:"],[-1,"<dbpassword>"],[1,"yesgoody2013"],[0,"@ds0"]],"start1":130,"start2":130,"length1":20,"length2":20}]],"length":1521,"saved":false}
{"ts":1355178497098,"patch":[[{"diffs":[[0,"err)"],[-1," {\n\t\t\t "],[1,"{"],[0," con"]],"start1":1302,"start2":1302,"length1":15,"length2":9}]],"length":1515,"saved":false}
{"ts":1355178501684,"patch":[[{"diffs":[[0,"ated!\");"],[-1,"\n\t\t  "],[0,"}\n\t\t  el"]],"start1":1324,"start2":1324,"length1":21,"length2":16}]],"length":1510,"saved":false}
{"ts":1355178510353,"patch":[[{"diffs":[[0,"lse{"],[-1,"\n\t\t  \t"],[0,"cons"]],"start1":1339,"start2":1339,"length1":14,"length2":8},{"diffs":[[0,"error\");"],[-1,"\n\t\t  "],[0,"}\n\t\t});\n"]],"start1":1363,"start2":1363,"length1":21,"length2":16}]],"length":1499,"saved":false}
{"ts":1355178593803,"patch":[[{"diffs":[[0,"ain page"],[1," powered by cloud9"],[0,"');\n});\n"]],"start1":670,"start2":670,"length1":16,"length2":34}]],"length":1517,"saved":false}
